<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="web.user.dao.face.ReviewCommentDao">

	<select id="selectComment" parameterType="web.user.dto.Review" resultType="web.user.dto.Rv_cmt">
		SELECT * FROM (
			SELECT rownum rnum, B.* FROM (
				SELECT
					comment_no
					, review_no
					, user_no
					, nick
					, comment_content
					, comment_write_date
				FROM Rv_cmt
				WHERE review_no = #{review_no}
				ORDER BY comment_write_date
			) B
		) ORDER BY rnum
	</select>
	
	<insert id="insertComment" parameterType="web.user.dto.Rv_cmt">
		INSERT INTO Rv_cmt (comment_no, review_no, user_no, nick, comment_content )
		VALUES ( Rv_cmt_seq.nextval, #{review_no}, #{user_no}, #{nick}, #{comment_content} )
	</insert>

	<delete id="deleteComment" parameterType="web.user.dto.Rv_cmt">
		DELETE Rv_cmt
		WHERE comment_no = #{comment_no}
	</delete>

	<select id="countComment" parameterType="web.user.dto.Rv_cmt" resultType="int">
		SELECT COUNT(*) 
		FROM Rv_cmt 
		WHERE comment_no = #{comment_no}
	</select>
	
	<update id="updateReviewComment" parameterType="web.user.dto.Rv_cmt">
		UPDATE Rv_cmt
		SET comment_content = #{comment_content}
		WHERE comment_no = #{comment_no}
	</update>


</mapper>